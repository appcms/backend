<div class="row header">
    <div class="col-sm-9 col-sm-offset-1">
        <h3 >Medienverwaltung</h3>
        <div class="btn-group btn-sorting" uib-dropdown>
            <button class="btn btn-default" id="dropdown-sorting" type="button" uib-dropdown-toggle>
                {{vm.schema.properties[vm.sortProperty].label}}
            </button>
            <button type="button" class="btn btn-default" ng-click="vm.sortBy(vm.sortProperty)">
                <span ng-show="vm.sortOrder === 'ASC'" class="glyphicon glyphicon-arrow-up"></span>
                <span ng-show="vm.sortOrder === 'DESC'" class="glyphicon glyphicon-arrow-down"></span>
            </button>
            <ul uib-dropdown-menu aria-labelledby="dropdown-sorting">
                <li ng-repeat="property in vm.schema.list"><a ng-click="vm.sortBy(property)">{{vm.schema.properties[property].label}}</a></li>
                <li><a ng-click="vm.sortBy('modified')">geändert am</a></li>
                <li><a ng-click="vm.sortBy('user')">geändert von</a></li>
            </ul>
        </div>
        <div class="btn-filter" uib-dropdown auto-close="outsideClick" is-open="vm.filterIsOpen">
            <button class="btn btn-default" id="dropdown-filter" type="button" uib-dropdown-toggle>
                Filter <span ng-show="vm.filterBadge" class="badge">{{vm.filterBadge}}</span> <span ng-hide="vm.filterBadge" class="glyphicon glyphicon-filter"></span>
            </button>
            <div uib-dropdown-menu aria-labelledby="dropdown-filter" class="form-inline">

                <div class="form-group" ng-hide="config.hide" ng-repeat="(key, config) in vm.schema.properties" ng-switch on="config.type" >
                    <label ng-switch-when="boolean">{{vm.schema.properties[key].label}}</label>
                    <select class="form-control" ng-switch-when="boolean" ng-model="vm.filter[key]" ng-change="vm.executeFilter()">
                        <option value="">alle</option>
                        <option value="true">ja</option>
                        <option value="false">nein</option>
                    </select>

                    <label ng-show="vm.filterJoins[key]" ng-switch-when="join">{{vm.schema.properties[key].label}}</label>
                    <select class="form-control" ng-show="vm.filterJoins[key]" ng-switch-when="join" ng-model="vm.filter[key]" ng-change="vm.executeFilter()">
                        <option value="">alle</option>
                        <option ng-repeat="option in vm.filterJoins[key]" value="{{option.id}}">{{option.title}}</option>
                    </select>

                    <label ng-switch-when="select">{{vm.schema.properties[key].label}}</label>
                    <select class="form-control" ng-switch-when="select" ng-model="vm.filter[key]" ng-change="vm.executeFilter()">
                        <option value="">alle</option>
                        <option ng-repeat="option in config.options" value="{{option.id}}">{{option.name}}</option>
                    </select>

                </div>
                <div class="form-group">
                    <label>Dateityp</label>
                    <select class="form-control" ng-model="vm.filter.mimetypes" ng-change="vm.executeFilter()">
                        <option value="">alle</option>
                        <option value="images">Bilder</option>
                        <option value="pdf">PDF-Dateien</option>
                        <option value="other">Sonstige Dateien</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ID</label>
                    <input type="text" class="form-control" ng-model="vm.filter.id" ng-enter="vm.closeFilter()" ng-change="vm.executeFilter()" ng-model-options="{debounce:500}">
                </div>
                <div class="form-group">
                    <label>Volltext</label>
                    <input type="text" class="form-control" ng-model="vm.filter.fulltext" ng-enter="vm.closeFilter()" ng-change="vm.executeFilter()" ng-model-options="{debounce:500}">
                </div>
                <div class="form-group">
                    <button class="btn btn-default" ng-click="vm.resetFilter()">Filter zurücksetzen</button>
                </div>

            </div>

        </div>
        <dir-pagination-controls on-page-change="vm.paginationChanged(newPageNumber)" pagination-id="files"></dir-pagination-controls>
    </div>

    <div class="col-sm-2">
        <button class="btn btn-primary btn-sm" ng-hide="vm.modaltitle" type="file" ngf-select="vm.uploadMultiFile($files, $invalidFiles)"
                multiple ngf-accept="'{{config.accept}}'"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Upload</button>
    </div>
</div>
<div class="row image-upload" ng-show="vm.fileUploads" ng-repeat="f in vm.fileUploads">
    <div class="col-sm-3 col-sm-offset-1">{{f.name}}</div>
    <div class="col-sm-6">
        <uib-progressbar ng-show="f.progress >= 0" max="max" value="f.progress">{{f.progress}} %</uib-progressbar>
    </div>
</div>
<div class="row">
    <div class="col-sm-10 col-sm-offset-1">
        <ul class="dynamic-grid" angular-grid="pics" grid-width="200" gutter-size="10" angular-grid-id="gallery" refresh-on-img-load="false"  ng-init="vm.loadData()">
            <li ng-click="vm.selectFile(object)" pagination-id="files" dir-paginate="object in vm.objects | itemsPerPage: vm.itemsPerPage" total-items="vm.totalItems" current-page="vm.currentPage" class="grid image-edit ng-class: {'isSelectable': vm.modaltitle}">
                <img src="/file/get/{{object.id}}/pim_small/{{object.name}}" class="grid-img" />
                <button ng-hide="modaltitle" class="btn btn-danger" ng-click="vm.delete(object.id, object.name)"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button>
                <button ng-hide="modaltitle" class="btn btn-default btn2" ng-click="vm.openForm(object)"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></button>
                <p><b>{{object.title || object.name}}</b><br>
                    Dateiname: {{object.name}}<br>
                    ID: {{object.id}}<br>
                    Dateigröße: {{object.size}}<br>
                    Hochgeladen: <pim-autoformat property="created" long="true" schema="vm.schema" object="object"></pim-autoformat><br>
                    Geändert: <pim-autoformat property="modified" long="true" schema="vm.schema" object="object"></pim-autoformat>
                </p>
            </li>
        </ul>
    </div>
</div>