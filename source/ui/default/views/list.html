<div class="row header">
    <div class="col-sm-8 col-sm-offset-1">
        <h3>{{schema.settings.label}} anzeigen</h3>
        <div class="btn-group btn-sorting" uib-dropdown>
            <button class="btn btn-default" id="dropdown-sorting" type="button" uib-dropdown-toggle>
                {{schema.properties[sortProperty].label}}
            </button>
            <button type="button" class="btn btn-default" ng-click="sortBy(sortProperty)">
                <span ng-show="sortOrder === 'ASC'" class="glyphicon glyphicon-arrow-up"></span>
                <span ng-show="sortOrder === 'DESC'" class="glyphicon glyphicon-arrow-down"></span>
            </button>
            <ul uib-dropdown-menu aria-labelledby="dropdown-sorting">
                <li ng-repeat="property in schema.list"><a ng-click="sortBy(property)">{{schema.properties[property].label}}</a></li>
                <li><a ng-click="sortBy('modified')">geändert am</a></li>
                <li><a ng-click="sortBy('user')">geändert von</a></li>
            </ul>
        </div>
        <div class="btn-filter" uib-dropdown auto-close="outsideClick" is-open="filterIsOpen">
            <button class="btn btn-default" id="dropdown-filter" type="button" uib-dropdown-toggle>
                Filter <span ng-show="filterBadge" class="badge">{{filterBadge}}</span> <span ng-hide="filterBadge" class="glyphicon glyphicon-filter"></span>
            </button>
            <div uib-dropdown-menu aria-labelledby="dropdown-filter" class="form-inline">

                    <div class="form-group" ng-hide="config.hide" ng-repeat="(key, config) in schema.properties" ng-switch on="config.type" >
                        <label ng-switch-when="boolean">{{schema.properties[key].label}}</label>
                        <select class="form-control" ng-switch-when="boolean" ng-model="filter[key]" ng-change="executeFilter()">
                            <option value="">alle</option>
                            <option value="true">ja</option>
                            <option value="false">nein</option>
                        </select>

                        <label ng-show="filterJoins[key]" ng-switch-when="join">{{schema.properties[key].label}}</label>
                        <select class="form-control" ng-show="filterJoins[key]" ng-switch-when="join" ng-model="filter[key]" ng-change="executeFilter()">
                            <option value="">alle</option>
                            <option ng-repeat="option in filterJoins[key]" value="{{option.id}}">{{option.title}}</option>
                        </select>

                        <label ng-switch-when="select">{{schema.properties[key].label}}</label>
                        <select class="form-control" ng-switch-when="select" ng-model="filter[key]" ng-change="executeFilter()">
                            <option value="">alle</option>
                            <option ng-repeat="option in config.options" value="{{option.id}}">{{option.name}}</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ID</label>
                        <input type="text" class="form-control" ng-model="filter.id" ng-enter="closeFilter()" ng-change="executeFilter()" ng-model-options="{debounce:500}">
                    </div>
                    <div class="form-group">
                        <label>Volltext</label>
                        <input type="text" class="form-control" ng-model="filter.fulltext" ng-enter="closeFilter()" ng-change="executeFilter()" ng-model-options="{debounce:500}">
                    </div>
                    <div class="form-group">
                        <button class="btn btn-default" ng-click="resetFilter()">Filter zurücksetzen</button>
                    </div>

            </div>
        </div>

        <dir-pagination-controls on-page-change="paginationChanged(newPageNumber)"></dir-pagination-controls>
    </div>

    <div class="col-sm-1">
        <button ng-show="devmode" class="btn btn-default btn-sm" ng-click="loadSchema()">Reload Schema</button>
    </div>
    <div class="col-sm-1">
        <button class="btn btn-primary btn-sm" ng-click="new()"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Objekt anlegen</button>
    </div>
</div>
<div class="row">
    <div class="col-sm-10 col-sm-offset-1">

        <p ng-hide="objectsAvailable || objectsNotAvailable">Daten werden geladen...</p>
        <p ng-show="objectsNotAvailable">Es sind derzeit leider keine Daten vorhanden.</p>
        <table class="table" ng-show="objectsAvailable">
            <thead>
                <tr>
                    <th class="ng-scope">ID</th>
                    <th ng-repeat="property in schema.list">{{schema.properties[property].label}}</th>
                    <th class="ng-scope">geändert am</th>
                    <th class="ng-scope">geändert von</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr dir-paginate="object in objects | itemsPerPage: itemsPerPage" total-items="totalItems" current-page="currentPage">
                    <td><pim-autoformat property="id" schema="schema" object="object"></pim-autoformat></td>
                    <td ng-repeat="property in schema.list"><pim-autoformat property="{{property}}" schema="schema" object="object"></pim-autoformat></td>
                    <td><pim-autoformat property="modified" long="true" schema="schema" object="object"></pim-autoformat></td>
                    <td><pim-autoformat property="user" schema="schema" object="object"></pim-autoformat></td>
                    <td>
                        <div class="pull-right">
                            <button ng-hide="schema.settings.isPush || schema.settings.readonly" ng-click="delete(object.id)" class="btn btn-danger btn-sm"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button>
                            <button ng-hide="schema.settings.isPush || schema.settings.readonly" ng-click="edit(object)" class="btn btn-primary btn-sm"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></button>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>

        <dir-pagination-controls ng-show="objectsAvailable" on-page-change="paginationChanged(newPageNumber)"></dir-pagination-controls>
    </div>
</div>